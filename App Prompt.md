### **Prompt مُوحَّد ومُحسَّن لتطبيق MediSwitch (جوال فقط):**

---

### **الهدف العام:**  
تصميم تطبيق جوال (**Android & iOS**) باسم **MediSwitch**، يجمع بين تحديث البيانات اليدوي عبر ملفات Excel وأدوات ذكية لحساب الجرعات، مع واجهة مستخدم عصرية تُشبه تطبيقات التواصل الاجتماعي في البساطة والجاذبية. التطبيق موجه للأطباء، الصيادلة، والمستخدمين العاديين، ويعمل كـ "صيدلية جيب" آمنة وسريعة **بدون حاجة لاتصال دائم بالإنترنت**.

---

### **الميزات الأساسية:**  

#### 1. **قاعدة البيانات (CSV/Excel → SQLite مشفَّرة):**  
   - استخدام ملف CSV مرفق يحتوي على **+23,000 دواء** كقاعدة بيانات أولية.  
      - عند رفع ملف Excel جديد عبر لوحة التحكم:  
           - **مسح كافة البيانات القديمة** واستبدالها بالجديدة.  
                - تشفير البيانات محليًّا باستخدام **SQLCipher**.  
                   - تنظيم الأدوية تلقائيًّا في فئات (مسكنات، مضادات حيوية، إلخ).  
                      - عرض تاريخ التحديث والسعر بجانب كل دواء.  

                      #### 2. **واجهة مستخدم مخصصة للجوال (Modern UI):**  
                         - تصميم **مُلهِم** يشبه تطبيقات مثل **Instagram** و **Telegram**، مع:  
                              - ألوان هادئة (أزرق طبي + رمادي).  
                                   - خطوط عربية واضحة (**Noto Sans Arabic**) مع دعم **RTL**.  
                                        - انتقالات سلسة (Animations) بين الشاشات.  
                                           - تبويبات سفلية للتنقل السريع:  
                                                - **الصفحة الرئيسية**: شريط بحث + أدوية مُحدَّثة.  
                                                     - **حاسبة الجرعات**: واجهة تفاعلية مع مُدخَّلات ذكية.  
                                                          - **الإعدادات**: تبديل اللغة، إدارة الاشتراك.  

                                                          #### 3. **بحث سريع وفلاتر ذكية:**  
                                                             - بحث بالاسم التجاري/المادة الفعالة مع **تصحيح تلقائي** للأخطاء الإملائية.  
                                                                - فلترة النتائج حسب:  
                                                                     - السعر (من الأقل إلى الأعلى).  
                                                                          - الفئة العلاجية (مُصنَّفة تلقائيًّا من CSV).  
                                                                               - التوفر في الصيدليات (إن وُجِدت البيانات).  

                                                                               #### 4. **أدوات جرعات مخصصة للجوال:**  
                                                                                  - **حاسبة الجرعة العادية:**  
                                                                                       - إدخال اسم الدواء + وزن المريض → عرض الجرعة اليومية.  
                                                                                            - **تحذير فوري** (صوتي + نص أحمر) عند تجاوز الجرعة الآمنة.  
                                                                                               - **حاسبة البدائل:**  
                                                                                                    - إدخال الدواء الأصلي + جرعته → اقتراح بدائل مع **نسبة تشابه دقيقة**.  

                                                                                                    #### 5. **نظام الإدارة (Admin Dashboard - ويب):**  
                                                                                                       - رفع ملفات Excel → معالجة الأخطاء تلقائيًّا (مثل أعمدة ناقصة).  
                                                                                                          - إحصائيات التطبيق: عدد المستخدمين النشطين، عمليات البحث الشائعة.  
                                                                                                             - ربط بحساب Google AdMob لإدارة الإعلانات.  

                                                                                                             ---

                                                                                                             ### **متطلبات فنية فائقة:**  

                                                                                                             #### 1. **الأداء:**  
                                                                                                                - تحميل البيانات خلال **<2 ثانية** حتى على اتصال 2G.  
                                                                                                                   - تخزين صور الأدوية مؤقتًا باستخدام **CachedNetworkImage**.  
                                                                                                                      - **Lazy Loading** لعرض الأدوية عند التمرير.  

                                                                                                                      #### 2. **الأمان:**  
                                                                                                                         - تشفير قاعدة البيانات بـ **SQLCipher** (AES-256).  
                                                                                                                            - منع لقطات الشاشة لصفحات الجرعات (**خاصة Android**).  

                                                                                                                            #### 3. **التوافق:**  
                                                                                                                               - دعم **Android 8.0+** و **iOS 13+**.  
                                                                                                                                  - تصميم متجاوب لجميع أحجام الشاشات (من iPhone SE إلى Samsung S24 Ultra).  

                                                                                                                                  ---

                                                                                                                                  ### **استراتيجية الربح:**  
                                                                                                                                  - **الإصدار المجاني:**  
                                                                                                                                    - إعلانات Banner غير مزعجة في أسفل الشاشة.  
                                                                                                                                      - إعلانات Interstitial كل 10 استخدامات.  
                                                                                                                                      - **الإصدار المميز (Premium):**  
                                                                                                                                        - إزالة الإعلانات.  
                                                                                                                                          - ميزة **حفظ سجل البحث** + تنبيهات بتغيرات الأسعار.  
                                                                                                                                            - سعر رمزي (**$1.99/شهريًّا**) مناسب للأسواق النامية.  

                                                                                                                                            ---

                                                                                                                                            ### **لماذا MediSwitch؟**  
                                                                                                                                            - **التحديث اليدوي**: لا حاجة لإعادة نشر التطبيق عند تحديث البيانات – يكفي رفع ملف Excel!  
                                                                                                                                            - **التصميم العصري**: واجهة مستخدم تُنافس التطبيقات العالمية (مثل Medscape) لكن بلمسة عربية.  
                                                                                                                                            - **الأمان المطلق**: تشفير البيانات حتى على أجهزة المستخدمين.  

                                                                                                                                            ---

                                                                                                                                            ### **التوثيق المطلوب:**  
                                                                                                                                            1. **كود تحميل CSV → SQLite:**  
                                                                                                                                            ```dart  
                                                                                                                                            Future<void> _updateDatabase(File newCsv) async {  
                                                                                                                                              final csvData = await newCsv.readAsString();  
                                                                                                                                                final List<Drug> newDrugs = CsvConverter.parse(csvData);  
                                                                                                                                                  await DatabaseHelper.instance.replaceAll(newDrugs); // استبدال كامل للبيانات  
                                                                                                                                                  }  
                                                                                                                                                  ```  

                                                                                                                                                  2. **وثيقة التصميم (Figma):**  
                                                                                                                                                     - رابط نموذج Figma جاهز مع تفاصيل كل عنصر (ألوان، خطوط، أنيميشنات).  

                                                                                                                                                     3. **دليل المطور:**  
                                                                                                                                                        - كيفية ربط لوحة التحكم بالتطبيق عبر Firebase (خطة مجانية).  
                                                                                                                                                           - إعداد SQLCipher للتشفير.  

                                                                                                                                                           ---

                                                                                                                                                           **اللمسة النهائية:**  
                                                                                                                                                           تصميم التطبيق يجب أن يشعر المستخدم بأنه "يُمسك بصيدلية بين يديه" – بسيط لكن قوي، سريع لكن آمن، وبالعربية لكن عالمي!